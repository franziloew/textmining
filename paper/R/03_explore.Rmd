---
title: "Topic Modeling of News"
author: "Franziska LÃ¶w"
date: "`r format(Sys.Date())`"
output: github_document
---

```{r, include=FALSE}
# load the packages
libs <- c("tidytext","tidyr","readr","lubridate","tm","stm","RColorBrewer",
          "plyr","dplyr","class","knitr","kableExtra","cldr","data.table",
          "htmlTable","ggplot2","gridExtra","jsonlite","stringr","scales","rjson")
lapply(libs, library, character.only = TRUE)
```

## Load Data
```{r}
rm(list = ls())
load("../output/news_cleaned2.Rda")

col <- brewer.pal(12, name = "Paired")
```

## Summary Stats
```{r}
df %>%
  group_by(site) %>%
  summarise(obs = n(),
    fb_shares.mean = mean(fb_shares),
            fb_shares.max = max(fb_shares),
            fb_likes.mean = mean(fb_likes),
            fb_likes.max = max(fb_likes),
            external_links.mean = mean(external_links),
            external_links.max = max(external_links),
            text_length.mean = mean(text_lenght),
            text_length.max = max(text_lenght)) %>%
  htmlTable(align = "l")
```

### Text Length
```{r}
ggplot(df, aes(x=as.factor(site), y=text_lenght)) +
  stat_summary(fun.y="median", geom="bar", fill = "blue", alpha = .5) +
  labs(title = "") +
  labs(x="", y="Median Text Length") +
  theme(axis.text.x = element_text(angle = 40, hjust = 1))
```

### Facebook Likes
```{r}
ggplot(df, aes(x=as.factor(site), y=fb_likes)) +
  stat_summary(fun.y="sum", geom="bar", fill = "blue", alpha = .5) +
  labs(title = "") +
  labs(x="", y="Sum of Facebook Likes") +
  theme(axis.text.x = element_text(angle = 40, hjust = 1))
```


